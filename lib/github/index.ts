import { Octokit } from "@octokit/rest"

// eslint-disable-next-line no-unused-vars
const TEST_DATA = [
  "2021-06-11T07:00:04.000-05:00",
  "2021-06-11T04:54:09.000-05:00",
  "2021-06-11T04:30:40.000-05:00",
  "2021-06-11T03:13:20.000-05:00",
  "2021-06-11T01:56:08.000-05:00",
  "2021-06-10T23:44:59.000-05:00",
  "2021-06-10T22:40:20.000-05:00",
  "2021-06-10T03:53:44.000-05:00",
  "2021-06-10T03:15:51.000-05:00",
  "2021-06-10T02:58:43.000-05:00",
  "2021-06-10T02:58:21.000-05:00",
  "2021-06-10T02:32:10.000-05:00",
  "2021-06-10T02:11:56.000-05:00",
  "2021-06-10T02:00:55.000-05:00",
  "2021-06-10T01:46:58.000-05:00",
  "2021-06-10T01:38:41.000-05:00",
  "2021-06-10T01:12:09.000-05:00",
  "2021-06-10T00:58:35.000-05:00",
  "2021-06-09T18:10:58.000-05:00",
  "2021-06-07T19:36:04.000-05:00",
  "2021-06-06T21:19:20.000-05:00",
  "2021-06-06T21:16:05.000-05:00",
  "2021-06-06T20:59:30.000-05:00",
  "2021-06-06T19:12:24.000-05:00",
  "2021-06-04T21:29:23.000-05:00",
  "2021-06-02T17:17:00.000-05:00",
  "2021-06-02T17:01:17.000-05:00",
  "2021-06-02T16:53:45.000-05:00",
  "2021-06-02T16:10:42.000-05:00",
  "2021-06-02T15:34:50.000-05:00",
  "2021-06-01T23:08:08.000-05:00",
  "2021-05-18T21:24:43.000-05:00",
  "2021-05-11T23:27:28.000-05:00",
  "2021-05-11T23:09:46.000-05:00",
  "2021-05-11T22:36:31.000-05:00",
  "2021-05-09T05:45:14.000-05:00",
  "2021-05-09T04:51:58.000-05:00",
  "2021-05-09T01:43:37.000-05:00",
  "2021-05-07T15:19:21.000-05:00",
  "2021-05-07T15:09:23.000-05:00",
  "2021-05-07T14:59:12.000-05:00",
  "2021-05-07T14:47:43.000-05:00",
  "2021-05-06T22:40:43.000-05:00",
  "2021-05-06T15:06:10.000-05:00",
  "2021-05-06T15:06:01.000-05:00",
  "2021-05-04T22:47:44.000-05:00",
  "2021-05-04T22:38:40.000-05:00",
  "2021-04-29T21:36:16.000-05:00",
  "2021-04-29T21:28:47.000-05:00",
  "2021-04-29T21:08:40.000-05:00",
  "2021-04-28T21:00:30.000-05:00",
  "2021-04-28T20:55:25.000-05:00",
  "2021-04-27T13:05:21.000-05:00",
  "2021-04-27T12:43:54.000-05:00",
  "2021-04-27T12:43:50.000-05:00",
  "2021-04-26T21:52:48.000-05:00",
  "2021-04-26T21:29:39.000-05:00",
  "2021-04-26T21:23:50.000-05:00",
  "2021-04-26T21:05:39.000-05:00",
  "2021-04-23T23:37:46.000-05:00",
  "2021-04-23T21:14:25.000-05:00",
  "2021-04-22T22:58:07.000-05:00",
  "2021-04-22T21:15:30.000-05:00",
  "2021-04-20T23:33:26.000-05:00",
  "2021-04-20T22:26:32.000-05:00",
  "2021-04-20T22:10:50.000-05:00",
  "2021-04-19T22:06:58.000-05:00",
  "2021-04-19T21:41:52.000-05:00",
  "2021-04-19T20:42:43.000-05:00",
  "2021-04-19T20:42:23.000-05:00",
  "2021-04-19T20:42:14.000-05:00",
  "2021-04-19T20:12:49.000-05:00",
  "2021-04-19T20:12:39.000-05:00",
  "2021-04-19T20:12:30.000-05:00",
  "2021-04-18T16:37:42.000-05:00",
  "2021-04-18T16:34:00.000-05:00",
  "2021-04-18T16:33:49.000-05:00",
  "2021-04-16T23:13:25.000-05:00",
  "2021-04-16T23:11:41.000-05:00",
  "2021-04-16T21:26:45.000-05:00",
  "2021-04-13T21:57:26.000-05:00",
  "2021-04-13T21:24:33.000-05:00",
  "2021-04-10T12:35:39.000-05:00",
  "2021-04-10T12:34:35.000-05:00",
  "2021-04-10T12:33:11.000-05:00",
  "2021-04-10T12:16:50.000-05:00",
  "2021-04-10T12:01:38.000-05:00",
  "2021-04-10T11:46:14.000-05:00",
  "2021-04-10T11:38:57.000-05:00",
  "2021-04-09T23:13:18.000-05:00",
  "2021-04-06T23:01:20.000-05:00",
  "2021-04-06T22:52:06.000-05:00",
  "2021-04-06T22:47:07.000-05:00",
  "2021-04-06T21:14:51.000-05:00",
  "2021-04-06T21:11:04.000-05:00",
  "2021-04-05T22:27:32.000-05:00",
  "2021-04-02T23:30:41.000-05:00",
  "2021-04-02T22:37:22.000-05:00",
  "2021-04-02T21:46:52.000-05:00",
  "2021-04-02T20:53:47.000-05:00",
]

const octokit = new Octokit({
  auth: process.env.NEXT_PUBLIC_GITHUB_ACCESS_TOKEN,
})

export const getRecentCommits = async () => {
  try {
    const { data } = await octokit.rest.search.commits({
      q: `author:xindixu`,
      sort: "author-date",
      order: "desc",
      per_page: 100,
    })
    return data?.items?.map(({ commit }) => commit?.author?.date)
  } catch (error) {
    return TEST_DATA
  }
}
